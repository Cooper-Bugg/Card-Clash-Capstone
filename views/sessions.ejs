<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title><%= pageTitle %> | Card Clash</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body class="page page-sessions">
    <div class="background-glow"></div>
    <header class="top-bar">
      <div class="brand">
        <div class="brand-title">Card Clash</div>
        <div class="brand-subtitle">Sessions</div>
      </div>
      <nav class="top-nav">
        <a class="nav-link" href="/dashboard">Dashboard</a>
        <a class="nav-link" href="/deck/new">Create Deck</a>
        <a class="nav-link is-active" href="/sessions">Sessions</a>
        <form method="post" action="/logout" style="margin: 0;">
          <button class="nav-link nav-link--danger" type="submit">Log Out</button>
        </form>
      </nav>
    </header>

    <main class="page-shell">
      <section class="panel hero-panel">
        <div>
          <h1>Past Sessions</h1>
          <p>Browse every game session your class has played. Click a session to read the AI report.</p>
        </div>
        <a class="btn btn-primary" href="/dashboard">Return to Dashboard</a>
      </section>

      <section class="panel">
        <div class="panel-header">
          <h2>All Sessions</h2>
          <span class="panel-meta"><%= sessions.length %> session<%= sessions.length !== 1 ? "s" : "" %></span>
        </div>

        <% if (sessions.length === 0) { %>
          <p style="color: var(--ink); opacity: 0.6;">No sessions yet. Launch a game to create your first session report.</p>
        <% } else { %>
          <div class="deck-list">
            <% for (let i = 0; i < sessions.length; i += 1) { %>
              <% const session = sessions[i]; %>
              <div class="deck-card">
                <div class="deck-card-info">
                  <div class="deck-card-title"><%= session.deckTitle %></div>
                  <div class="deck-card-meta">
                    <%= session.createdAt %> &nbsp;·&nbsp;
                    <%= session.metrics.roundsPlayed %> rounds &nbsp;·&nbsp;
                    Accuracy: <%= session.metrics.averageAccuracy %>
                  </div>
                  <% if (session.summaryPreview) { %>
                    <p style="margin: 0.5rem 0 0; font-size: 0.88rem; color: var(--ink); opacity: 0.75;">
                      <%= session.summaryPreview %>
                    </p>
                  <% } %>
                </div>
                <div class="deck-card-actions">
                  <a class="btn btn-primary" href="/report/<%= session.id %>">View Report</a>
                </div>
              </div>
            <% } %>
          </div>
        <% } %>
      </section>
    </main>
  </body>
</html>
